"use client";
import React, { useState } from "react";

type SwipeTrackProps = {
  onSwipe: () => void;
  allTracksTracked: boolean;
};

function SwipeTrack({ onSwipe, allTracksTracked }: SwipeTrackProps) {
  const [startX, setStartX] = useState(0);
  const [offset, setOffset] = useState(0);
  const [swiped, setSwiped] = useState(false);

  const handleTouchStart = (event: any) => {
    console.log("touch start", event.touches[0].clientX);
    setStartX(event.touches[0].clientX);
  };

  const handleTouchMove = (event: any) => {
    if (!startX || allTracksTracked) return;
    const currentX = event.touches[0].clientX;
    const deltaX = currentX - startX;
    setOffset(deltaX);
  };

  const handleTouchEnd = () => {
    setStartX(0);
    if (offset !== 0 && !allTracksTracked) {
      setSwiped(true);
      onSwipe();
    }
    setOffset(0);
  };

  return (
    <div
      onTouchStart={handleTouchStart}
      onTouchMove={handleTouchMove}
      onTouchEnd={handleTouchEnd}
      style={{ touchAction: "none", cursor: "grab", overflow: "hidden" }}
      className={`w-full h-[50px] flex items-center justify-between px-1 rounded-[38.03px]
                ${allTracksTracked ? "bg-green-600" : "bg-[#d15439]"}
            `}
    >
      {/** left */}
      {!allTracksTracked ? (
        <svg
          style={{ transform: `translateX(${offset}px)` }}
          width="41"
          height="40"
          viewBox="0 0 41 40"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <ellipse
            cx="20.6567"
            cy="20"
            rx="20"
            ry="20"
            fill="url(#paint0_linear_1_886)"
          />
          <path
            d="M8.74406 24V18.32H6.50406V17H12.6041V18.32H10.3641V24H8.74406ZM13.3485 24V18.62H14.8385V20.14L14.6285 19.7C14.7885 19.32 15.0452 19.0333 15.3985 18.84C15.7518 18.64 16.1818 18.54 16.6885 18.54V19.98C16.6218 19.9733 16.5618 19.97 16.5085 19.97C16.4552 19.9633 16.3985 19.96 16.3385 19.96C15.9118 19.96 15.5652 20.0833 15.2985 20.33C15.0385 20.57 14.9085 20.9467 14.9085 21.46V24H13.3485ZM20.6645 24V22.95L20.5645 22.72V20.84C20.5645 20.5067 20.4612 20.2467 20.2545 20.06C20.0545 19.8733 19.7445 19.78 19.3245 19.78C19.0379 19.78 18.7545 19.8267 18.4745 19.92C18.2012 20.0067 17.9679 20.1267 17.7745 20.28L17.2145 19.19C17.5079 18.9833 17.8612 18.8233 18.2745 18.71C18.6879 18.5967 19.1079 18.54 19.5345 18.54C20.3545 18.54 20.9912 18.7333 21.4445 19.12C21.8979 19.5067 22.1245 20.11 22.1245 20.93V24H20.6645ZM19.0245 24.08C18.6045 24.08 18.2445 24.01 17.9445 23.87C17.6445 23.7233 17.4145 23.5267 17.2545 23.28C17.0945 23.0333 17.0145 22.7567 17.0145 22.45C17.0145 22.13 17.0912 21.85 17.2445 21.61C17.4045 21.37 17.6545 21.1833 17.9945 21.05C18.3345 20.91 18.7779 20.84 19.3245 20.84H20.7545V21.75H19.4945C19.1279 21.75 18.8745 21.81 18.7345 21.93C18.6012 22.05 18.5345 22.2 18.5345 22.38C18.5345 22.58 18.6112 22.74 18.7645 22.86C18.9245 22.9733 19.1412 23.03 19.4145 23.03C19.6745 23.03 19.9079 22.97 20.1145 22.85C20.3212 22.7233 20.4712 22.54 20.5645 22.3L20.8045 23.02C20.6912 23.3667 20.4845 23.63 20.1845 23.81C19.8845 23.99 19.4979 24.08 19.0245 24.08ZM26.2755 24.08C25.6955 24.08 25.1788 23.9633 24.7255 23.73C24.2721 23.49 23.9155 23.16 23.6555 22.74C23.4021 22.32 23.2755 21.8433 23.2755 21.31C23.2755 20.77 23.4021 20.2933 23.6555 19.88C23.9155 19.46 24.2721 19.1333 24.7255 18.9C25.1788 18.66 25.6955 18.54 26.2755 18.54C26.8421 18.54 27.3355 18.66 27.7555 18.9C28.1755 19.1333 28.4855 19.47 28.6855 19.91L27.4755 20.56C27.3355 20.3067 27.1588 20.12 26.9455 20C26.7388 19.88 26.5121 19.82 26.2655 19.82C25.9988 19.82 25.7588 19.88 25.5455 20C25.3321 20.12 25.1621 20.29 25.0355 20.51C24.9155 20.73 24.8555 20.9967 24.8555 21.31C24.8555 21.6233 24.9155 21.89 25.0355 22.11C25.1621 22.33 25.3321 22.5 25.5455 22.62C25.7588 22.74 25.9988 22.8 26.2655 22.8C26.5121 22.8 26.7388 22.7433 26.9455 22.63C27.1588 22.51 27.3355 22.32 27.4755 22.06L28.6855 22.72C28.4855 23.1533 28.1755 23.49 27.7555 23.73C27.3355 23.9633 26.8421 24.08 26.2755 24.08ZM30.9444 22.9L30.9844 21L33.4944 18.62H35.3544L32.9444 21.07L32.1344 21.73L30.9444 22.9ZM29.6544 24V16.58H31.2144V24H29.6544ZM33.6644 24L31.8444 21.74L32.8244 20.53L35.5544 24H33.6644Z"
            fill="#D15439"
          />
          <defs>
            <linearGradient
              id="paint0_linear_1_886"
              x1="31.9901"
              y1="5.33334"
              x2="7.65674"
              y2="31.3333"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#E1DFE3" />
              <stop offset="1" stop-color="#FAF6FF" />
            </linearGradient>
          </defs>
        </svg>
      ) : (
        <div className="bg-gray-100 rounded-full w-[41px] h-[40px] flex items-center justify-center">
          <svg
            width="50px"
            height="50px"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M10.5859 13.4142L7.75748 10.5858L6.34326 12L10.5859 16.2426L17.657 9.17154L16.2428 7.75732L10.5859 13.4142Z"
              fill="#50c878"
            />
          </svg>
        </div>
      )}

      {/** text */}
      <div className="w-[149px] h-[10px] flex items-center justify-center">
        <h2 className="font-semibold text-[14px] leading-[17px] text-center text-[#ffffff]">
          {allTracksTracked ? "All tracks completed" : "Swipe to track all"}
        </h2>
      </div>

      {/** right */}
      <svg
        width="46"
        height="19"
        viewBox="0 0 46 19"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.75258 15.1579C6.54593 14.9512 6.52714 14.6278 6.69622 14.4L6.75258 14.3347L11.7736 9.31344L6.75258 4.29221C6.54593 4.08555 6.52714 3.76217 6.69622 3.53429L6.75258 3.46901C6.95924 3.26235 7.28262 3.24357 7.5105 3.41265L7.57578 3.46901L13.0086 8.90184C13.2153 9.1085 13.2341 9.43188 13.065 9.65976L13.0086 9.72504L7.57578 15.1579C7.34846 15.3852 6.9799 15.3852 6.75258 15.1579Z"
          fill="#FAF6FF"
          fill-opacity="0.18"
        />
        <path
          d="M19.9466 15.1579C19.74 14.9512 19.7212 14.6278 19.8903 14.4L19.9466 14.3347L24.9676 9.31344L19.9466 4.29221C19.74 4.08555 19.7212 3.76217 19.8903 3.53429L19.9466 3.46901C20.1533 3.26235 20.4766 3.24357 20.7045 3.41265L20.7698 3.46901L26.2026 8.90184C26.4093 9.1085 26.4281 9.43188 26.259 9.65976L26.2026 9.72504L20.7698 15.1579C20.5425 15.3852 20.1739 15.3852 19.9466 15.1579Z"
          fill="#FAF6FF"
          fill-opacity="0.5"
        />
        <path
          d="M33.1406 15.1579C32.934 14.9512 32.9152 14.6278 33.0843 14.4L33.1406 14.3347L38.1616 9.31344L33.1406 4.29221C32.934 4.08555 32.9152 3.76217 33.0843 3.53429L33.1406 3.46901C33.3473 3.26235 33.6707 3.24357 33.8986 3.41265L33.9638 3.46901L39.3967 8.90184C39.6033 9.1085 39.6221 9.43188 39.453 9.65976L39.3967 9.72504L33.9638 15.1579C33.7365 15.3852 33.368 15.3852 33.1406 15.1579Z"
          fill="#FAF6FF"
        />
      </svg>
    </div>
  );
}

export default SwipeTrack;
